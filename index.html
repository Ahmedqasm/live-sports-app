<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <title>IPTV Player Pro</title>
    <script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
    <style>
        body { background: #000; color: #0f0; font-family: monospace; display: flex; flex-direction: column; align-items: center; padding-top: 50px; }
        video { width: 90%; max-width: 800px; border: 2px solid #333; box-shadow: 0 0 20px #222; }
        .box { margin-top: 20px; padding: 15px; border: 1px solid #333; width: 80%; text-align: center; }
        .error-msg { color: #ff4444; display: none; margin-top: 10px; }
    </style>
</head>
<body>

    <h3>نظام تشغيل البث المباشر (تجاوز القيود)</h3>
    <video id="video" controls autoplay></video>
    
    <div class="box">
        <div id="status">جاري محاكاة اتصال VLC...</div>
        <div id="error" class="error-msg">فشل الاتصال: السيرفر يرفض الطلبات من المتصفحات.</div>
    </div>

<script>
    // الرابط الخاص بك
    const originalUrl = "http://6d.tanres.us:80/play/live.php?mac=00:1A:79:BE:57:AB&stream=1178453&extension=m3u8&play_token=2ctTZQeSkL";
    
    // استخدام بروكسي "AllOrigins" لجلب البث كبيانات خام لتخطي حظر السيرفر للمتصفحات
    const proxyUrl = "https://api.allorigins.win/raw?url=" + encodeURIComponent(originalUrl);

    const video = document.getElementById('video');
    
    if (Hls.isSupported()) {
        const hls = new Hls({
            xhrSetup: function(xhr, url) {
                // محاكاة هوية VLC أو جهاز MAG
                xhr.setRequestHeader('User-Agent', 'VLC/3.0.12 LibVLC/3.0.12');
            }
        });
        
        hls.loadSource(proxyUrl);
        hls.attachMedia(video);
        
        hls.on(Hls.Events.MANIFEST_PARSED, function() {
            document.getElementById('status').innerText = "✅ تم كسر الحماية.. البث يعمل الآن";
            video.play();
        });

        hls.on(Hls.Events.ERROR, function(event, data) {
            if (data.fatal) {
                document.getElementById('error').style.display = 'block';
                document.getElementById('status').innerText = "❌ فشل";
            }
        });
    }
</script>
</body>
</html>
